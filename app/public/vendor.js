(function(){function n(n){function e(e,t,r,o,i,a){for(;i>=0&&i<a;i+=n){var u=o?o[i]:i;r=t(r,e[u],u,e)}return r}return function(t,r,o,i){r=w(r,i,4);var a=!A(t)&&m.keys(t),u=(a||t).length,l=n>0?0:u-1;return arguments.length<3&&(o=t[a?a[l]:l],l+=n),e(t,r,o,a,l,u)}}function e(n){return function(e,t,r){t=x(t,r);for(var o=O(e),i=n>0?0:o-1;i>=0&&i<o;i+=n)if(t(e[i],i,e))return i;return-1}}function t(n,e,t){return function(r,o,i){var a=0,u=O(r);if("number"==typeof i)n>0?a=i>=0?i:Math.max(i+u,a):u=i>=0?Math.min(i+1,u):i+u+1;else if(t&&i&&u)return i=t(r,o),r[i]===o?i:-1;if(o!==o)return i=e(s.call(r,a,u),m.isNaN),i>=0?i+a:-1;for(i=n>0?a:u-1;i>=0&&i<u;i+=n)if(r[i]===o)return i;return-1}}function r(n,e){var t=T.length,r=n.constructor,o=m.isFunction(r)&&r.prototype||u,i="constructor";for(m.has(n,i)&&!m.contains(e,i)&&e.push(i);t--;)i=T[t],i in n&&n[i]!==o[i]&&!m.contains(e,i)&&e.push(i)}var o=this,i=o._,a=Array.prototype,u=Object.prototype,l=Function.prototype,c=a.push,s=a.slice,f=u.toString,d=u.hasOwnProperty,p=Array.isArray,h=Object.keys,v=l.bind,g=Object.create,y=function(){},m=function(n){return n instanceof m?n:this instanceof m?void(this._wrapped=n):new m(n)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=m),exports._=m):o._=m,m.VERSION="1.8.3";var w=function(n,e,t){if(void 0===e)return n;switch(null==t?3:t){case 1:return function(t){return n.call(e,t)};case 2:return function(t,r){return n.call(e,t,r)};case 3:return function(t,r,o){return n.call(e,t,r,o)};case 4:return function(t,r,o,i){return n.call(e,t,r,o,i)}}return function(){return n.apply(e,arguments)}},x=function(n,e,t){return null==n?m.identity:m.isFunction(n)?w(n,e,t):m.isObject(n)?m.matcher(n):m.property(n)};m.iteratee=function(n,e){return x(n,e,1/0)};var b=function(n,e){return function(t){var r=arguments.length;if(r<2||null==t)return t;for(var o=1;o<r;o++)for(var i=arguments[o],a=n(i),u=a.length,l=0;l<u;l++){var c=a[l];e&&void 0!==t[c]||(t[c]=i[c])}return t}},j=function(n){if(!m.isObject(n))return{};if(g)return g(n);y.prototype=n;var e=new y;return y.prototype=null,e},k=function(n){return function(e){return null==e?void 0:e[n]}},E=Math.pow(2,53)-1,O=k("length"),A=function(n){var e=O(n);return"number"==typeof e&&e>=0&&e<=E};m.each=m.forEach=function(n,e,t){e=w(e,t);var r,o;if(A(n))for(r=0,o=n.length;r<o;r++)e(n[r],r,n);else{var i=m.keys(n);for(r=0,o=i.length;r<o;r++)e(n[i[r]],i[r],n)}return n},m.map=m.collect=function(n,e,t){e=x(e,t);for(var r=!A(n)&&m.keys(n),o=(r||n).length,i=Array(o),a=0;a<o;a++){var u=r?r[a]:a;i[a]=e(n[u],u,n)}return i},m.reduce=m.foldl=m.inject=n(1),m.reduceRight=m.foldr=n(-1),m.find=m.detect=function(n,e,t){var r;if(r=A(n)?m.findIndex(n,e,t):m.findKey(n,e,t),void 0!==r&&r!==-1)return n[r]},m.filter=m.select=function(n,e,t){var r=[];return e=x(e,t),m.each(n,function(n,t,o){e(n,t,o)&&r.push(n)}),r},m.reject=function(n,e,t){return m.filter(n,m.negate(x(e)),t)},m.every=m.all=function(n,e,t){e=x(e,t);for(var r=!A(n)&&m.keys(n),o=(r||n).length,i=0;i<o;i++){var a=r?r[i]:i;if(!e(n[a],a,n))return!1}return!0},m.some=m.any=function(n,e,t){e=x(e,t);for(var r=!A(n)&&m.keys(n),o=(r||n).length,i=0;i<o;i++){var a=r?r[i]:i;if(e(n[a],a,n))return!0}return!1},m.contains=m.includes=m.include=function(n,e,t,r){return A(n)||(n=m.values(n)),("number"!=typeof t||r)&&(t=0),m.indexOf(n,e,t)>=0},m.invoke=function(n,e){var t=s.call(arguments,2),r=m.isFunction(e);return m.map(n,function(n){var o=r?e:n[e];return null==o?o:o.apply(n,t)})},m.pluck=function(n,e){return m.map(n,m.property(e))},m.where=function(n,e){return m.filter(n,m.matcher(e))},m.findWhere=function(n,e){return m.find(n,m.matcher(e))},m.max=function(n,e,t){var r,o,i=-(1/0),a=-(1/0);if(null==e&&null!=n){n=A(n)?n:m.values(n);for(var u=0,l=n.length;u<l;u++)r=n[u],r>i&&(i=r)}else e=x(e,t),m.each(n,function(n,t,r){o=e(n,t,r),(o>a||o===-(1/0)&&i===-(1/0))&&(i=n,a=o)});return i},m.min=function(n,e,t){var r,o,i=1/0,a=1/0;if(null==e&&null!=n){n=A(n)?n:m.values(n);for(var u=0,l=n.length;u<l;u++)r=n[u],r<i&&(i=r)}else e=x(e,t),m.each(n,function(n,t,r){o=e(n,t,r),(o<a||o===1/0&&i===1/0)&&(i=n,a=o)});return i},m.shuffle=function(n){for(var e,t=A(n)?n:m.values(n),r=t.length,o=Array(r),i=0;i<r;i++)e=m.random(0,i),e!==i&&(o[i]=o[e]),o[e]=t[i];return o},m.sample=function(n,e,t){return null==e||t?(A(n)||(n=m.values(n)),n[m.random(n.length-1)]):m.shuffle(n).slice(0,Math.max(0,e))},m.sortBy=function(n,e,t){return e=x(e,t),m.pluck(m.map(n,function(n,t,r){return{value:n,index:t,criteria:e(n,t,r)}}).sort(function(n,e){var t=n.criteria,r=e.criteria;if(t!==r){if(t>r||void 0===t)return 1;if(t<r||void 0===r)return-1}return n.index-e.index}),"value")};var N=function(n){return function(e,t,r){var o={};return t=x(t,r),m.each(e,function(r,i){var a=t(r,i,e);n(o,r,a)}),o}};m.groupBy=N(function(n,e,t){m.has(n,t)?n[t].push(e):n[t]=[e]}),m.indexBy=N(function(n,e,t){n[t]=e}),m.countBy=N(function(n,e,t){m.has(n,t)?n[t]++:n[t]=1}),m.toArray=function(n){return n?m.isArray(n)?s.call(n):A(n)?m.map(n,m.identity):m.values(n):[]},m.size=function(n){return null==n?0:A(n)?n.length:m.keys(n).length},m.partition=function(n,e,t){e=x(e,t);var r=[],o=[];return m.each(n,function(n,t,i){(e(n,t,i)?r:o).push(n)}),[r,o]},m.first=m.head=m.take=function(n,e,t){if(null!=n)return null==e||t?n[0]:m.initial(n,n.length-e)},m.initial=function(n,e,t){return s.call(n,0,Math.max(0,n.length-(null==e||t?1:e)))},m.last=function(n,e,t){if(null!=n)return null==e||t?n[n.length-1]:m.rest(n,Math.max(0,n.length-e))},m.rest=m.tail=m.drop=function(n,e,t){return s.call(n,null==e||t?1:e)},m.compact=function(n){return m.filter(n,m.identity)};var C=function(n,e,t,r){for(var o=[],i=0,a=r||0,u=O(n);a<u;a++){var l=n[a];if(A(l)&&(m.isArray(l)||m.isArguments(l))){e||(l=C(l,e,t));var c=0,s=l.length;for(o.length+=s;c<s;)o[i++]=l[c++]}else t||(o[i++]=l)}return o};m.flatten=function(n,e){return C(n,e,!1)},m.without=function(n){return m.difference(n,s.call(arguments,1))},m.uniq=m.unique=function(n,e,t,r){m.isBoolean(e)||(r=t,t=e,e=!1),null!=t&&(t=x(t,r));for(var o=[],i=[],a=0,u=O(n);a<u;a++){var l=n[a],c=t?t(l,a,n):l;e?(a&&i===c||o.push(l),i=c):t?m.contains(i,c)||(i.push(c),o.push(l)):m.contains(o,l)||o.push(l)}return o},m.union=function(){return m.uniq(C(arguments,!0,!0))},m.intersection=function(n){for(var e=[],t=arguments.length,r=0,o=O(n);r<o;r++){var i=n[r];if(!m.contains(e,i)){for(var a=1;a<t&&m.contains(arguments[a],i);a++);a===t&&e.push(i)}}return e},m.difference=function(n){var e=C(arguments,!0,!0,1);return m.filter(n,function(n){return!m.contains(e,n)})},m.zip=function(){return m.unzip(arguments)},m.unzip=function(n){for(var e=n&&m.max(n,O).length||0,t=Array(e),r=0;r<e;r++)t[r]=m.pluck(n,r);return t},m.object=function(n,e){for(var t={},r=0,o=O(n);r<o;r++)e?t[n[r]]=e[r]:t[n[r][0]]=n[r][1];return t},m.findIndex=e(1),m.findLastIndex=e(-1),m.sortedIndex=function(n,e,t,r){t=x(t,r,1);for(var o=t(e),i=0,a=O(n);i<a;){var u=Math.floor((i+a)/2);t(n[u])<o?i=u+1:a=u}return i},m.indexOf=t(1,m.findIndex,m.sortedIndex),m.lastIndexOf=t(-1,m.findLastIndex),m.range=function(n,e,t){null==e&&(e=n||0,n=0),t=t||1;for(var r=Math.max(Math.ceil((e-n)/t),0),o=Array(r),i=0;i<r;i++,n+=t)o[i]=n;return o};var _=function(n,e,t,r,o){if(!(r instanceof e))return n.apply(t,o);var i=j(n.prototype),a=n.apply(i,o);return m.isObject(a)?a:i};m.bind=function(n,e){if(v&&n.bind===v)return v.apply(n,s.call(arguments,1));if(!m.isFunction(n))throw new TypeError("Bind must be called on a function");var t=s.call(arguments,2),r=function(){return _(n,r,e,this,t.concat(s.call(arguments)))};return r},m.partial=function(n){var e=s.call(arguments,1),t=function(){for(var r=0,o=e.length,i=Array(o),a=0;a<o;a++)i[a]=e[a]===m?arguments[r++]:e[a];for(;r<arguments.length;)i.push(arguments[r++]);return _(n,t,this,this,i)};return t},m.bindAll=function(n){var e,t,r=arguments.length;if(r<=1)throw new Error("bindAll must be passed function names");for(e=1;e<r;e++)t=arguments[e],n[t]=m.bind(n[t],n);return n},m.memoize=function(n,e){var t=function(r){var o=t.cache,i=""+(e?e.apply(this,arguments):r);return m.has(o,i)||(o[i]=n.apply(this,arguments)),o[i]};return t.cache={},t},m.delay=function(n,e){var t=s.call(arguments,2);return setTimeout(function(){return n.apply(null,t)},e)},m.defer=m.partial(m.delay,m,1),m.throttle=function(n,e,t){var r,o,i,a=null,u=0;t||(t={});var l=function(){u=t.leading===!1?0:m.now(),a=null,i=n.apply(r,o),a||(r=o=null)};return function(){var c=m.now();u||t.leading!==!1||(u=c);var s=e-(c-u);return r=this,o=arguments,s<=0||s>e?(a&&(clearTimeout(a),a=null),u=c,i=n.apply(r,o),a||(r=o=null)):a||t.trailing===!1||(a=setTimeout(l,s)),i}},m.debounce=function(n,e,t){var r,o,i,a,u,l=function(){var c=m.now()-a;c<e&&c>=0?r=setTimeout(l,e-c):(r=null,t||(u=n.apply(i,o),r||(i=o=null)))};return function(){i=this,o=arguments,a=m.now();var c=t&&!r;return r||(r=setTimeout(l,e)),c&&(u=n.apply(i,o),i=o=null),u}},m.wrap=function(n,e){return m.partial(e,n)},m.negate=function(n){return function(){return!n.apply(this,arguments)}},m.compose=function(){var n=arguments,e=n.length-1;return function(){for(var t=e,r=n[e].apply(this,arguments);t--;)r=n[t].call(this,r);return r}},m.after=function(n,e){return function(){if(--n<1)return e.apply(this,arguments)}},m.before=function(n,e){var t;return function(){return--n>0&&(t=e.apply(this,arguments)),n<=1&&(e=null),t}},m.once=m.partial(m.before,2);var S=!{toString:null}.propertyIsEnumerable("toString"),T=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];m.keys=function(n){if(!m.isObject(n))return[];if(h)return h(n);var e=[];for(var t in n)m.has(n,t)&&e.push(t);return S&&r(n,e),e},m.allKeys=function(n){if(!m.isObject(n))return[];var e=[];for(var t in n)e.push(t);return S&&r(n,e),e},m.values=function(n){for(var e=m.keys(n),t=e.length,r=Array(t),o=0;o<t;o++)r[o]=n[e[o]];return r},m.mapObject=function(n,e,t){e=x(e,t);for(var r,o=m.keys(n),i=o.length,a={},u=0;u<i;u++)r=o[u],a[r]=e(n[r],r,n);return a},m.pairs=function(n){for(var e=m.keys(n),t=e.length,r=Array(t),o=0;o<t;o++)r[o]=[e[o],n[e[o]]];return r},m.invert=function(n){for(var e={},t=m.keys(n),r=0,o=t.length;r<o;r++)e[n[t[r]]]=t[r];return e},m.functions=m.methods=function(n){var e=[];for(var t in n)m.isFunction(n[t])&&e.push(t);return e.sort()},m.extend=b(m.allKeys),m.extendOwn=m.assign=b(m.keys),m.findKey=function(n,e,t){e=x(e,t);for(var r,o=m.keys(n),i=0,a=o.length;i<a;i++)if(r=o[i],e(n[r],r,n))return r},m.pick=function(n,e,t){var r,o,i={},a=n;if(null==a)return i;m.isFunction(e)?(o=m.allKeys(a),r=w(e,t)):(o=C(arguments,!1,!1,1),r=function(n,e,t){return e in t},a=Object(a));for(var u=0,l=o.length;u<l;u++){var c=o[u],s=a[c];r(s,c,a)&&(i[c]=s)}return i},m.omit=function(n,e,t){if(m.isFunction(e))e=m.negate(e);else{var r=m.map(C(arguments,!1,!1,1),String);e=function(n,e){return!m.contains(r,e)}}return m.pick(n,e,t)},m.defaults=b(m.allKeys,!0),m.create=function(n,e){var t=j(n);return e&&m.extendOwn(t,e),t},m.clone=function(n){return m.isObject(n)?m.isArray(n)?n.slice():m.extend({},n):n},m.tap=function(n,e){return e(n),n},m.isMatch=function(n,e){var t=m.keys(e),r=t.length;if(null==n)return!r;for(var o=Object(n),i=0;i<r;i++){var a=t[i];if(e[a]!==o[a]||!(a in o))return!1}return!0};var M=function(n,e,t,r){if(n===e)return 0!==n||1/n===1/e;if(null==n||null==e)return n===e;n instanceof m&&(n=n._wrapped),e instanceof m&&(e=e._wrapped);var o=f.call(n);if(o!==f.call(e))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+n==""+e;case"[object Number]":return+n!==+n?+e!==+e:0===+n?1/+n===1/e:+n===+e;case"[object Date]":case"[object Boolean]":return+n===+e}var i="[object Array]"===o;if(!i){if("object"!=typeof n||"object"!=typeof e)return!1;var a=n.constructor,u=e.constructor;if(a!==u&&!(m.isFunction(a)&&a instanceof a&&m.isFunction(u)&&u instanceof u)&&"constructor"in n&&"constructor"in e)return!1}t=t||[],r=r||[];for(var l=t.length;l--;)if(t[l]===n)return r[l]===e;if(t.push(n),r.push(e),i){if(l=n.length,l!==e.length)return!1;for(;l--;)if(!M(n[l],e[l],t,r))return!1}else{var c,s=m.keys(n);if(l=s.length,m.keys(e).length!==l)return!1;for(;l--;)if(c=s[l],!m.has(e,c)||!M(n[c],e[c],t,r))return!1}return t.pop(),r.pop(),!0};m.isEqual=function(n,e){return M(n,e)},m.isEmpty=function(n){return null==n||(A(n)&&(m.isArray(n)||m.isString(n)||m.isArguments(n))?0===n.length:0===m.keys(n).length)},m.isElement=function(n){return!(!n||1!==n.nodeType)},m.isArray=p||function(n){return"[object Array]"===f.call(n)},m.isObject=function(n){var e=typeof n;return"function"===e||"object"===e&&!!n},m.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(n){m["is"+n]=function(e){return f.call(e)==="[object "+n+"]"}}),m.isArguments(arguments)||(m.isArguments=function(n){return m.has(n,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(m.isFunction=function(n){return"function"==typeof n||!1}),m.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))},m.isNaN=function(n){return m.isNumber(n)&&n!==+n},m.isBoolean=function(n){return n===!0||n===!1||"[object Boolean]"===f.call(n)},m.isNull=function(n){return null===n},m.isUndefined=function(n){return void 0===n},m.has=function(n,e){return null!=n&&d.call(n,e)},m.noConflict=function(){return o._=i,this},m.identity=function(n){return n},m.constant=function(n){return function(){return n}},m.noop=function(){},m.property=k,m.propertyOf=function(n){return null==n?function(){}:function(e){return n[e]}},m.matcher=m.matches=function(n){return n=m.extendOwn({},n),function(e){return m.isMatch(e,n)}},m.times=function(n,e,t){var r=Array(Math.max(0,n));e=w(e,t,1);for(var o=0;o<n;o++)r[o]=e(o);return r},m.random=function(n,e){return null==e&&(e=n,n=0),n+Math.floor(Math.random()*(e-n+1))},m.now=Date.now||function(){return(new Date).getTime()};var R={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},I=m.invert(R),F=function(n){var e=function(e){return n[e]},t="(?:"+m.keys(n).join("|")+")",r=RegExp(t),o=RegExp(t,"g");return function(n){return n=null==n?"":""+n,r.test(n)?n.replace(o,e):n}};m.escape=F(R),m.unescape=F(I),m.result=function(n,e,t){var r=null==n?void 0:n[e];return void 0===r&&(r=t),m.isFunction(r)?r.call(n):r};var B=0;m.uniqueId=function(n){var e=++B+"";return n?n+e:e},m.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var D=/(.)^/,L={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},$=/\\|'|\r|\n|\u2028|\u2029/g,q=function(n){return"\\"+L[n]};m.template=function(n,e,t){!e&&t&&(e=t),e=m.defaults({},e,m.templateSettings);var r=RegExp([(e.escape||D).source,(e.interpolate||D).source,(e.evaluate||D).source].join("|")+"|$","g"),o=0,i="__p+='";n.replace(r,function(e,t,r,a,u){return i+=n.slice(o,u).replace($,q),o=u+e.length,t?i+="'+\n((__t=("+t+"))==null?'':_.escape(__t))+\n'":r?i+="'+\n((__t=("+r+"))==null?'':__t)+\n'":a&&(i+="';\n"+a+"\n__p+='"),e}),i+="';\n",e.variable||(i="with(obj||{}){\n"+i+"}\n"),i="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+i+"return __p;\n";try{var a=new Function(e.variable||"obj","_",i)}catch(u){throw u.source=i,u}var l=function(n){return a.call(this,n,m)},c=e.variable||"obj";return l.source="function("+c+"){\n"+i+"}",l},m.chain=function(n){var e=m(n);return e._chain=!0,e};var z=function(n,e){return n._chain?m(e).chain():e};m.mixin=function(n){m.each(m.functions(n),function(e){var t=m[e]=n[e];m.prototype[e]=function(){var n=[this._wrapped];return c.apply(n,arguments),z(this,t.apply(m,n))}})},m.mixin(m),m.each(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var e=a[n];m.prototype[n]=function(){var t=this._wrapped;return e.apply(t,arguments),"shift"!==n&&"splice"!==n||0!==t.length||delete t[0],z(this,t)}}),m.each(["concat","join","slice"],function(n){var e=a[n];m.prototype[n]=function(){return z(this,e.apply(this._wrapped,arguments))}}),m.prototype.value=function(){return this._wrapped},m.prototype.valueOf=m.prototype.toJSON=m.prototype.value,m.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return m})}).call(this);var m=function n(e,t){function r(n){_=n.document,S=n.location,M=n.cancelAnimationFrame||n.clearTimeout,T=n.requestAnimationFrame||n.setTimeout}function o(){var n,e=[].slice.call(arguments),t=!(null==e[1]||D.call(e[1])!==R||"tag"in e[1]||"view"in e[1]||"subtree"in e[1]),r=t?e[1]:{},o="class"in r?"class":"className",i={tag:"div",attrs:{}},a=[];if(D.call(e[0])!=F)throw new Error("selector in m(selector, attrs, children) should be a string");for(;n=L.exec(e[0]);)if(""===n[1]&&n[2])i.tag=n[2];else if("#"===n[1])i.attrs.id=n[2];else if("."===n[1])a.push(n[2]);else if("["===n[3][0]){var u=$.exec(n[3]);i.attrs[u[1]]=u[3]||!u[2]||""}var l=t?e.slice(2):e.slice(1);1===l.length&&D.call(l[0])===I?i.children=l[0]:i.children=l;for(var c in r)r.hasOwnProperty(c)&&(c===o&&null!=r[c]&&""!==r[c]?(a.push(r[c]),i.attrs[c]=""):i.attrs[c]=r[c]);return a.length>0&&(i.attrs[o]=a.join(" ")),i}function i(n,e,r,c,f,d,p,h,v,g,y){try{null!=f&&null!=f.toString()||(f="")}catch(m){f=""}if("retain"===f.subtree)return d;var w=D.call(d),x=D.call(f);if(null==d||w!==x){if(null!=d)if(r&&r.nodes){var b=h-c,j=b+(x===I?f:d.nodes).length;l(r.nodes.slice(b,j),r.slice(b,j))}else d.nodes&&l(d.nodes,d);d=new f.constructor,d.tag&&(d={}),d.nodes=[]}if(x===I){for(var k=0,E=f.length;k<E;k++)D.call(f[k])===I&&(f=f.concat.apply([],f),k--,E=f.length);for(var O=[],A=d.length===f.length,N=0,C=1,S=2,T=3,M={},L=!1,k=0;k<d.length;k++)d[k]&&d[k].attrs&&null!=d[k].attrs.key&&(L=!0,M[d[k].attrs.key]={action:C,index:k});for(var $=0,k=0,E=f.length;k<E;k++)if(f[k]&&f[k].attrs&&null!=f[k].attrs.key){for(var K=0,E=f.length;K<E;K++)f[K]&&f[K].attrs&&null==f[K].attrs.key&&(f[K].attrs.key="__mithril__"+$++);break}if(L){var U=!1;if(f.length!=d.length)U=!0;else for(var H,J,k=0;H=d[k],J=f[k];k++)if(H.attrs&&J.attrs&&H.attrs.key!=J.attrs.key){U=!0;break}if(U){for(var k=0,E=f.length;k<E;k++)if(f[k]&&f[k].attrs&&null!=f[k].attrs.key){var P=f[k].attrs.key;M[P]?M[P]={action:T,index:k,from:M[P].index,element:d.nodes[M[P].index]||_.createElement("div")}:M[P]={action:S,index:k}}var G=[];for(var V in M)G.push(M[V]);var Q=G.sort(a),W=new Array(d.length);W.nodes=d.nodes.slice();for(var Y,k=0;Y=Q[k];k++){if(Y.action===C&&(l(d[Y.index].nodes,d[Y.index]),W.splice(Y.index,1)),Y.action===S){var X=_.createElement("div");X.key=f[Y.index].attrs.key,n.insertBefore(X,n.childNodes[Y.index]||null),W.splice(Y.index,0,{attrs:{key:f[Y.index].attrs.key},nodes:[X]}),W.nodes[Y.index]=X}Y.action===T&&(n.childNodes[Y.index]!==Y.element&&null!==Y.element&&n.insertBefore(Y.element,n.childNodes[Y.index]||null),W[Y.index]=d[Y.from],W.nodes[Y.index]=Y.element)}d=W}}for(var k=0,Z=0,E=f.length;k<E;k++){var en=i(n,e,d,h,f[k],d[Z],p,h+N||N,v,g,y);en!==t&&(en.nodes.intact||(A=!1),N+=en.$trusted?(en.match(/<[^\/]|\>\s*[^<]/g)||[0]).length:D.call(en)===I?en.length:1,d[Z++]=en)}if(!A){for(var k=0,E=f.length;k<E;k++)null!=d[k]&&O.push.apply(O,d[k].nodes);for(var tn,k=0;tn=d.nodes[k];k++)null!=tn.parentNode&&O.indexOf(tn)<0&&l([tn],[d[k]]);f.length<d.length&&(d.length=f.length),d.nodes=O}}else if(null!=f&&x===R){for(var on=[],an=[];f.view;){var un=f.view.$original||f.view,ln="diff"==o.redraw.strategy()&&d.views?d.views.indexOf(un):-1,cn=ln>-1?d.controllers[ln]:new(f.controller||z),P=f&&f.attrs&&f.attrs.key;if(f=0==rn||d&&d.controllers&&d.controllers.indexOf(cn)>-1?f.view(cn):{tag:"placeholder"},"retain"===f.subtree)return d;P&&(f.attrs||(f.attrs={}),f.attrs.key=P),cn.onunload&&nn.push({controller:cn,handler:cn.onunload}),on.push(un),an.push(cn)}if(!f.tag&&an.length)throw new Error("Component template must return a virtual element, not an array, string, etc.");f.attrs||(f.attrs={}),d.attrs||(d.attrs={});var sn=Object.keys(f.attrs),fn=sn.length>("key"in f.attrs?1:0);if((f.tag!=d.tag||sn.sort().join()!=Object.keys(d.attrs).sort().join()||f.attrs.id!=d.attrs.id||f.attrs.key!=d.attrs.key||"all"==o.redraw.strategy()&&(!d.configContext||d.configContext.retain!==!0)||"diff"==o.redraw.strategy()&&d.configContext&&d.configContext.retain===!1)&&(d.nodes.length&&l(d.nodes),d.configContext&&typeof d.configContext.onunload===B&&d.configContext.onunload(),d.controllers))for(var cn,k=0;cn=d.controllers[k];k++)typeof cn.onunload===B&&cn.onunload({preventDefault:z});if(D.call(f.tag)!=F)return;var tn,dn=0===d.nodes.length;if(f.attrs.xmlns?g=f.attrs.xmlns:"svg"===f.tag?g="http://www.w3.org/2000/svg":"math"===f.tag&&(g="http://www.w3.org/1998/Math/MathML"),dn){if(tn=f.attrs.is?g===t?_.createElement(f.tag,f.attrs.is):_.createElementNS(g,f.tag,f.attrs.is):g===t?_.createElement(f.tag):_.createElementNS(g,f.tag),d={tag:f.tag,attrs:fn?u(tn,f.tag,f.attrs,{},g):f.attrs,children:null!=f.children&&f.children.length>0?i(tn,f.tag,t,t,f.children,d.children,!0,0,f.attrs.contenteditable?tn:v,g,y):f.children,nodes:[tn]},an.length){d.views=on,d.controllers=an;for(var cn,k=0;cn=an[k];k++)if(cn.onunload&&cn.onunload.$old&&(cn.onunload=cn.onunload.$old),rn&&cn.onunload){var pn=cn.onunload;cn.onunload=z,cn.onunload.$old=pn}}d.children&&!d.children.nodes&&(d.children.nodes=[]),"select"===f.tag&&"value"in f.attrs&&u(tn,f.tag,{value:f.attrs.value},{},g),n.insertBefore(tn,n.childNodes[h]||null)}else tn=d.nodes[0],fn&&u(tn,f.tag,f.attrs,d.attrs,g),d.children=i(tn,f.tag,t,t,f.children,d.children,!1,0,f.attrs.contenteditable?tn:v,g,y),d.nodes.intact=!0,an.length&&(d.views=on,d.controllers=an),p===!0&&null!=tn&&n.insertBefore(tn,n.childNodes[h]||null);if(typeof f.attrs.config===B){var hn=d.configContext=d.configContext||{},vn=function(n,e){return function(){return n.attrs.config.apply(n,e)}};y.push(vn(f,[tn,!dn,hn,d]))}}else if(typeof f!=B){var O;0===d.nodes.length?(f.$trusted?O=s(n,h,f):(O=[_.createTextNode(f)],n.nodeName.match(q)||n.insertBefore(O[0],n.childNodes[h]||null)),d="string number boolean".indexOf(typeof f)>-1?new f.constructor(f):f,d.nodes=O):d.valueOf()!==f.valueOf()||p===!0?(O=d.nodes,v&&v===_.activeElement||(f.$trusted?(l(O,d),O=s(n,h,f)):"textarea"===e?n.value=f:v?v.innerHTML=f:((1===O[0].nodeType||O.length>1)&&(l(d.nodes,d),O=[_.createTextNode(f)]),n.insertBefore(O[0],n.childNodes[h]||null),O[0].nodeValue=f)),d=new f.constructor(f),d.nodes=O):d.nodes.intact=!0}return d}function a(n,e){return n.action-e.action||n.index-e.index}function u(n,e,t,r,o){for(var i in t){var a=t[i],u=r[i];if(i in r&&u===a)"value"===i&&"input"===e&&n.value!=a&&(n.value=a);else{r[i]=a;try{if("config"===i||"key"==i)continue;if(typeof a===B&&0===i.indexOf("on"))n[i]=f(a,n);else if("style"===i&&null!=a&&D.call(a)===R){for(var l in a)null!=u&&u[l]===a[l]||(n.style[l]=a[l]);for(var l in u)l in a||(n.style[l]="")}else null!=o?"href"===i?n.setAttributeNS("http://www.w3.org/1999/xlink","href",a):"className"===i?n.setAttribute("class",a):n.setAttribute(i,a):i in n&&"list"!==i&&"style"!==i&&"form"!==i&&"type"!==i&&"width"!==i&&"height"!==i?"input"===e&&n[i]===a||(n[i]=a):n.setAttribute(i,a)}catch(c){if(c.message.indexOf("Invalid argument")<0)throw c}}}return r}function l(n,e){for(var t=n.length-1;t>-1;t--)if(n[t]&&n[t].parentNode){try{n[t].parentNode.removeChild(n[t])}catch(r){}e=[].concat(e),e[t]&&c(e[t])}0!=n.length&&(n.length=0)}function c(n){if(n.configContext&&typeof n.configContext.onunload===B&&(n.configContext.onunload(),n.configContext.onunload=null),n.controllers)for(var e,t=0;e=n.controllers[t];t++)typeof e.onunload===B&&e.onunload({preventDefault:z});if(n.children)if(D.call(n.children)===I)for(var r,t=0;r=n.children[t];t++)c(r);else n.children.tag&&c(n.children)}function s(n,e,t){var r=n.childNodes[e];if(r){var o=1!=r.nodeType,i=_.createElement("span");o?(n.insertBefore(i,r||null),i.insertAdjacentHTML("beforebegin",t),n.removeChild(i)):r.insertAdjacentHTML("beforebegin",t)}else n.insertAdjacentHTML("beforeend",t);for(var a=[];n.childNodes[e]!==r;)a.push(n.childNodes[e]),e++;return a}function f(n,e){return function(t){t=t||event,o.redraw.strategy("diff"),o.startComputation();try{return n.call(e,t)}finally{on()}}}function d(n){var e=H.indexOf(n);return e<0?H.push(n)-1:e}function p(n){var e=function(){return arguments.length&&(n=arguments[0]),n};return e.toJSON=function(){return n},e}function h(n,e){var t=function(){return(n.controller||z).apply(this,e)||this},r=function(t){return arguments.length>1&&(e=e.concat([].slice.call(arguments,1))),n.view.apply(n,e?[t].concat(e):[t])};r.$original=n.view;var o={controller:t,view:r};return e[0]&&null!=e[0].key&&(o.attrs={key:e[0].key}),o}function v(){X&&(X(),X=null);for(var n,e=0;n=G[e];e++)if(Q[e]){var t=V[e].controller&&V[e].controller.$$args?[Q[e]].concat(V[e].controller.$$args):[Q[e]];o.render(n,V[e].view?V[e].view(Q[e],t):"")}Z&&(Z(),Z=null),W=null,Y=new Date,o.redraw.strategy("diff")}function g(n){return n.slice(ln[o.route.mode].length)}function y(n,e,t){an={};var r=t.indexOf("?");r!==-1&&(an=b(t.substr(r+1,t.length)),t=t.substr(0,r));var i=Object.keys(e),a=i.indexOf(t);if(a!==-1)return o.mount(n,e[i[a]]),!0;for(var u in e){if(u===t)return o.mount(n,e[u]),!0;var l=new RegExp("^"+u.replace(/:[^\/]+?\.{3}/g,"(.*?)").replace(/:[^\/]+/g,"([^\\/]+)")+"/?$");if(l.test(t))return t.replace(l,function(){for(var t=u.match(/:[^\/]+/g)||[],r=[].slice.call(arguments,1,-2),i=0,a=t.length;i<a;i++)an[t[i].replace(/:|\./g,"")]=decodeURIComponent(r[i]);o.mount(n,e[u])}),!0}}function m(n){if(n=n||event,!n.ctrlKey&&!n.metaKey&&2!==n.which){n.preventDefault?n.preventDefault():n.returnValue=!1;for(var e=n.currentTarget||n.srcElement,t="pathname"===o.route.mode&&e.search?b(e.search.slice(1)):{};e&&"A"!=e.nodeName.toUpperCase();)e=e.parentNode;o.route(e[o.route.mode].slice(ln[o.route.mode].length),t)}}function w(){"hash"!=o.route.mode&&S.hash?S.hash=S.hash:e.scrollTo(0,0)}function x(n,e){var r={},o=[];for(var i in n){var a=e?e+"["+i+"]":i,u=n[i],l=D.call(u),c=null===u?encodeURIComponent(a):l===R?x(u,a):l===I?u.reduce(function(n,e){return r[a]||(r[a]={}),r[a][e]?n:(r[a][e]=!0,n.concat(encodeURIComponent(a)+"="+encodeURIComponent(e)))},[]).join("&"):encodeURIComponent(a)+"="+encodeURIComponent(u);u!==t&&o.push(c)}return o.join("&")}function b(n){"?"===n.charAt(0)&&(n=n.substring(1));for(var e=n.split("&"),t={},r=0,o=e.length;r<o;r++){var i=e[r].split("="),a=decodeURIComponent(i[0]),u=2==i.length?decodeURIComponent(i[1]):null;null!=t[a]?(D.call(t[a])!==I&&(t[a]=[t[a]]),t[a].push(u)):t[a]=u}return t}function j(n){var e=d(n);l(n.childNodes,J[e]),J[e]=t}function k(n,e){var t=o.prop(e);return n.then(t),t.then=function(t,r){return k(n.then(t,r),e)},t}function E(n,e){function t(n){f=n||c,p.map(function(n){f===l&&n.resolve(d)||n.reject(d)})}function r(n,e,t,r){if((null!=d&&D.call(d)===R||typeof d===B)&&typeof n===B)try{var i=0;n.call(d,function(n){i++||(d=n,e())},function(n){i++||(d=n,t())})}catch(a){o.deferred.onerror(a),d=a,t()}else r()}function i(){var c;try{c=d&&d.then}catch(p){return o.deferred.onerror(p),d=p,f=u,i()}r(c,function(){f=a,i()},function(){f=u,i()},function(){try{f===a&&typeof n===B?d=n(d):f===u&&"function"==typeof e&&(d=e(d),f=a)}catch(i){return o.deferred.onerror(i),d=i,t()}d===s?(d=TypeError(),t()):r(c,function(){t(l)},t,function(){t(f===a&&l)})})}var a=1,u=2,l=3,c=4,s=this,f=0,d=0,p=[];s.promise={},s.resolve=function(n){return f||(d=n,f=a,i()),this},s.reject=function(n){return f||(d=n,f=u,i()),this},s.promise.then=function(n,e){var t=new E(n,e);return f===l?t.resolve(d):f===c?t.reject(d):p.push(t),t.promise}}function O(n){return n}function A(n){if(!n.dataType||"jsonp"!==n.dataType.toLowerCase()){var r=new e.XMLHttpRequest;if(r.open(n.method,n.url,!0,n.user,n.password),r.onreadystatechange=function(){4===r.readyState&&(r.status>=200&&r.status<300?n.onload({type:"load",target:r}):n.onerror({type:"error",target:r}))},n.serialize===JSON.stringify&&n.data&&"GET"!==n.method&&r.setRequestHeader("Content-Type","application/json; charset=utf-8"),n.deserialize===JSON.parse&&r.setRequestHeader("Accept","application/json, text/*"),typeof n.config===B){var o=n.config(r,n);null!=o&&(r=o)}var i="GET"!==n.method&&n.data?n.data:"";if(i&&D.call(i)!=F&&i.constructor!=e.FormData)throw"Request data should be either be a string or FormData. Check the `serialize` option in `m.request`";return r.send(i),r}var a="mithril_callback_"+(new Date).getTime()+"_"+Math.round(1e16*Math.random()).toString(36),u=_.createElement("script");e[a]=function(r){u.parentNode.removeChild(u),n.onload({type:"load",target:{responseText:r}}),e[a]=t},u.onerror=function(r){return u.parentNode.removeChild(u),n.onerror({type:"error",target:{status:500,responseText:JSON.stringify({error:"Error making jsonp request"})}}),e[a]=t,!1},u.onload=function(n){return!1},u.src=n.url+(n.url.indexOf("?")>0?"&":"?")+(n.callbackKey?n.callbackKey:"callback")+"="+a+"&"+x(n.data||{}),_.body.appendChild(u)}function N(n,e,t){if("GET"===n.method&&"jsonp"!=n.dataType){var r=n.url.indexOf("?")<0?"?":"&",o=x(e);n.url=n.url+(o?r+o:"")}else n.data=t(e);return n}function C(n,e){var t=n.match(/:[a-z]\w+/gi);if(t&&e)for(var r=0;r<t.length;r++){var o=t[r].slice(1);n=n.replace(t[r],e[o]),delete e[o]}return n}var _,S,T,M,R="[object Object]",I="[object Array]",F="[object String]",B="function",D={}.toString,L=/(?:(^|#|\.)([^#\.\[\]]+))|(\[.+?\])/g,$=/\[(.+?)(?:=("|'|)(.*?)\2)?\]/,q=/^(AREA|BASE|BR|COL|COMMAND|EMBED|HR|IMG|INPUT|KEYGEN|LINK|META|PARAM|SOURCE|TRACK|WBR)$/,z=function(){};r(e);var K,U={appendChild:function(n){K===t&&(K=_.createElement("html")),_.documentElement&&_.documentElement!==n?_.replaceChild(n,_.documentElement):_.appendChild(n),this.childNodes=_.childNodes},insertBefore:function(n){this.appendChild(n)},childNodes:[]},H=[],J={};o.render=function(n,e,r){var o=[];if(!n)throw new Error("Ensure the DOM element being passed to m.route/m.mount/m.render is not undefined.");var a=d(n),u=n===_,c=u||n===_.documentElement?U:n;u&&"html"!=e.tag&&(e={tag:"html",attrs:{},children:e}),J[a]===t&&l(c.childNodes),r===!0&&j(n),J[a]=i(c,null,t,t,e,J[a],!1,0,null,t,o);for(var s=0,f=o.length;s<f;s++)o[s]()},o.trust=function(n){return n=new String(n),n.$trusted=!0,n},o.prop=function(n){return(null!=n&&D.call(n)===R||typeof n===B)&&typeof n.then===B?k(n):p(n)};var P,G=[],V=[],Q=[],W=null,Y=0,X=null,Z=null,nn=[],en=16;o.component=function(n){return h(n,[].slice.call(arguments,1))},o.mount=o.module=function(n,e){if(!n)throw new Error("Please ensure the DOM element exists before rendering a template into it.");var t=G.indexOf(n);t<0&&(t=G.length);for(var r,i=!1,a={preventDefault:function(){i=!0,X=Z=null}},u=0;r=nn[u];u++)r.handler.call(r.controller,a),r.controller.onunload=null;if(i)for(var r,u=0;r=nn[u];u++)r.controller.onunload=r.handler;else nn=[];if(Q[t]&&typeof Q[t].onunload===B&&Q[t].onunload(a),!i){o.redraw.strategy("all"),o.startComputation(),G[t]=n,arguments.length>2&&(e=subcomponent(e,[].slice.call(arguments,2)));var l=P=e=e||{controller:function(){}},c=e.controller||z,s=new c;return l===P&&(Q[t]=s,V[t]=e),on(),Q[t]}};var tn=!1;o.redraw=function(n){tn||(tn=!0,W&&n!==!0?(T===e.requestAnimationFrame||new Date-Y>en)&&(W>0&&M(W),W=T(v,en)):(v(),W=T(function(){W=null},en)),tn=!1)},o.redraw.strategy=o.prop();var rn=0;o.startComputation=function(){rn++},o.endComputation=function(){rn=Math.max(rn-1,0),0===rn&&o.redraw()};var on=function(){"none"==o.redraw.strategy()?(rn--,o.redraw.strategy("diff")):o.endComputation()};o.withAttr=function(n,e){return function(t){t=t||event;var r=t.currentTarget||this;e(n in r?r[n]:r.getAttribute(n))}};var an,un,ln={pathname:"",hash:"#",search:"?"},cn=z,sn=!1;return o.route=function(){if(0===arguments.length)return un;if(3===arguments.length&&D.call(arguments[1])===F){var n=arguments[0],t=arguments[1],r=arguments[2];cn=function(e){var i=un=g(e);if(!y(n,r,i)){if(sn)throw new Error("Ensure the default route matches one of the routes defined in m.route");sn=!0,o.route(t,!0),sn=!1}};var i="hash"===o.route.mode?"onhashchange":"onpopstate";e[i]=function(){var n=S[o.route.mode];"pathname"===o.route.mode&&(n+=S.search),un!=g(n)&&cn(n);
},X=w,e[i]()}else if(arguments[0].addEventListener||arguments[0].attachEvent){var a=arguments[0],u=(arguments[1],arguments[2],arguments[3]);a.href=("pathname"!==o.route.mode?S.pathname:"")+ln[o.route.mode]+u.attrs.href,a.addEventListener?(a.removeEventListener("click",m),a.addEventListener("click",m)):(a.detachEvent("onclick",m),a.attachEvent("onclick",m))}else if(D.call(arguments[0])===F){var l=un;un=arguments[0];var c=arguments[1]||{},s=un.indexOf("?"),f=s>-1?b(un.slice(s+1)):{};for(var d in c)f[d]=c[d];var p=x(f),h=s>-1?un.slice(0,s):un;p&&(un=h+(h.indexOf("?")===-1?"?":"&")+p);var v=(3===arguments.length?arguments[2]:arguments[1])===!0||l===arguments[0];e.history.pushState?(X=w,Z=function(){e.history[v?"replaceState":"pushState"](null,_.title,ln[o.route.mode]+un)},cn(ln[o.route.mode]+un)):(S[o.route.mode]=un,cn(ln[o.route.mode]+un))}},o.route.param=function(n){if(!an)throw new Error("You must call m.route(element, defaultRoute, routes) before calling m.route.param()");return an[n]},o.route.mode="search",o.route.buildQueryString=x,o.route.parseQueryString=b,o.deferred=function(){var n=new E;return n.promise=k(n.promise),n},o.deferred.onerror=function(n){if("[object Error]"===D.call(n)&&!n.constructor.toString().match(/ Error/))throw n},o.sync=function(n){function e(n,e){return function(o){return a[n]=o,e||(t="reject"),0===--i&&(r.promise(a),r[t](a)),o}}var t="resolve",r=o.deferred(),i=n.length,a=new Array(i);if(n.length>0)for(var u=0;u<n.length;u++)n[u].then(e(u,!0),e(u,!1));else r.resolve([]);return r.promise},o.request=function(n){n.background!==!0&&o.startComputation();var e=new E,t=n.dataType&&"jsonp"===n.dataType.toLowerCase(),r=n.serialize=t?O:n.serialize||JSON.stringify,i=n.deserialize=t?O:n.deserialize||JSON.parse,a=t?function(n){return n.responseText}:n.extract||function(n){return 0===n.responseText.length&&i===JSON.parse?null:n.responseText};return n.method=(n.method||"GET").toUpperCase(),n.url=C(n.url,n.data),n=N(n,n.data,r),n.onload=n.onerror=function(t){try{t=t||event;var r=("load"===t.type?n.unwrapSuccess:n.unwrapError)||O,u=r(i(a(t.target,n)),t.target);if("load"===t.type)if(D.call(u)===I&&n.type)for(var l=0;l<u.length;l++)u[l]=new n.type(u[l]);else n.type&&(u=new n.type(u));e["load"===t.type?"resolve":"reject"](u)}catch(t){o.deferred.onerror(t),e.reject(t)}n.background!==!0&&o.endComputation()},A(n),e.promise=k(e.promise,n.initialValue),e.promise},o.deps=function(n){return r(e=n||e),e},o.deps.factory=n,o}("undefined"!=typeof window?window:{});"undefined"!=typeof module&&null!==module&&module.exports?module.exports=m:"function"==typeof define&&define.amd&&define(function(){return m});